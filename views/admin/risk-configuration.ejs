<%- include('../layouts/main', { title: 'Risk Configuration' }) %>

<% layout('layouts/main') -%>

<section class="container admin-config" style="max-width:1100px;margin:28px auto;">
  <div class="panel" style="background:#fff;padding:18px;border-radius:8px;box-shadow:0 6px 20px rgba(15,23,42,0.06)">
    <div class="panel-header" style="display:flex;justify-content:space-between;align-items:center">
      <h2>Risk Configuration</h2>
      <div>
        <button id="saveBtn" class="btn primary">Save Changes</button>
      </div>
    </div>
    <p class="help">Adjust the scoring thresholds and weights for each risk dimension.</p>

    <div class="grid" style="display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-top:12px">
      <div>
        <table class="config-table" style="width:100%;border-collapse:collapse">
          <thead>
            <tr style="text-align:left;color:#374151;font-weight:700">
              <th>Dimension</th>
              <th>Low Risk (0–30)</th>
              <th>Medium Risk (31–60)</th>
              <th>High Risk (61–100)</th>
              <th>Weight</th>
            </tr>
          </thead>
          <tbody>
            <% const dims = ['Architecture','Security','Performance','Code Quality & Standards','Release Readiness']; %>
            <% dims.forEach(function(dim,i){ %>
            <tr style="border-top:1px solid #eef2f6">
              <td style="padding:10px 8px"><%= dim %></td>
              <td style="padding:8px"><select class="range from"><option>0</option></select></td>
              <td style="padding:8px"><select class="range mid"><option>31</option></select></td>
              <td style="padding:8px"><select class="range to"><option>61</option></select></td>
              <td style="padding:8px"><input type="number" class="weight" value="<%= [25,30,20,10,15][i] %>" min="0" max="100"></td>
            </tr>
            <% }) %>
          </tbody>
        </table>

        <div style="margin-top:18px;background:#fbfbfd;padding:12px;border-radius:6px;border:1px solid #f1f5f9">
          <div style="display:flex;gap:12px;align-items:center">
            <div style="flex:1">
              <label style="font-weight:700;color:#374151">Risk Score Aggregation</label>
              <div style="color:#6b7280;margin-top:6px">Set the weight contribution for each dimension (sums to 100%).</div>
            </div>
            <div style="display:flex;gap:8px">
              <input type="text" value="25% - 25%" style="border:1px solid #e6eef8;padding:6px;border-radius:4px;background:#fff">
              <input type="text" value="30% - 20%" style="border:1px solid #e6eef8;padding:6px;border-radius:4px;background:#fff">
            </div>
          </div>
        </div>

        <h3 style="margin-top:18px">Risk Level Labels</h3>
        <table style="width:100%;border-collapse:collapse;margin-top:8px">
          <thead>
            <tr style="text-align:left;color:#374151;font-weight:700">
              <th style="width:200px">Range</th>
              <th>Label</th>
              <th>Color</th>
              <th>Display</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-top:1px solid #eef2f6">
              <td style="padding:8px">0 — 30</td>
              <td style="padding:8px"><select><option>Low</option></select></td>
              <td style="padding:8px"><button class="btn" style="background:#16a34a;color:#fff;border:none;padding:6px 10px;border-radius:6px">LOW</button></td>
              <td style="padding:8px"><select><option>Low</option></select></td>
            </tr>
            <tr style="border-top:1px solid #eef2f6">
              <td style="padding:8px">31 — 60</td>
              <td style="padding:8px"><select><option>Medium</option></select></td>
              <td style="padding:8px"><button class="btn" style="background:#f59e0b;color:#fff;border:none;padding:6px 10px;border-radius:6px">MEDIUM</button></td>
              <td style="padding:8px"><select><option>Medium</option></select></td>
            </tr>
            <tr style="border-top:1px solid #eef2f6">
              <td style="padding:8px">61 — 100</td>
              <td style="padding:8px"><select><option>High</option></select></td>
              <td style="padding:8px"><button class="btn" style="background:#ef4444;color:#fff;border:none;padding:6px 10px;border-radius:6px">HIGH</button></td>
              <td style="padding:8px"><select><option>High</option></select></td>
            </tr>
          </tbody>
        </table>

      </div>

      <aside style="background:#fff;border-radius:6px;padding:12px;border:1px solid #f1f5f9">
        <h4 style="margin-top:0">Notes:</h4>
        <ul style="color:#6b7280">
          <li>Adjust the scoring thresholds and weights for each risk dimension.</li>
          <li>Total Risk Score is weighted as: Security (30%), Architecture (25%), Performance (20%), Release Readiness (15%), Code Quality (10%).</li>
        </ul>
      </aside>
    </div>
  </div>
</section>

<script>
  // Save button wired to call existing admin API
  document.getElementById('saveBtn').addEventListener('click', async ()=>{
    alert('This view is a static demo; use the admin API to save changes.');
  });
</script>